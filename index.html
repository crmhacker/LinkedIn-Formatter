<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CRM Hacker – LinkedIn Text Formatter</title>
  <meta name="description" content="AuthoredUp-style LinkedIn text formatter reimagined for CRM Hacker. Bold, italic, underline, strikethrough, lists, fancy Unicode fonts, sentence strike, staircase (sort by length), device preview, image attach, copy to clipboard.">
  <style>
    :root{
      /* CRM Hacker brand */
      --accent:#ff2c2c;               /* red */
      --accent-2:#ff5858;
      --bg:#0b0c10;                   /* dark gradient base */
      --bg-2:#0e1016;
      --panel:#121318;                 /* cards */
      --ink:#ffffff;                   /* primary text */
      --muted:#a9adba;                 /* secondary text */
      --line:#24283b;                  /* borders */
      --ok:#18c37d;                    /* success */
      --warn:#ffb020;                  /* warnings */
      --li-blue:#0a66c2;               /* LinkedIn blue for preview */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:linear-gradient(180deg,var(--bg),var(--bg-2));
         color:var(--ink);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
    a{color:var(--accent)}

    .wrap{max-width:1280px;margin:28px auto;padding:0 16px}
    .topbar{display:flex;align-items:center;gap:12px;margin-bottom:14px}
    .topbar img{height:54px;width:auto;background:#000;border-radius:10px;padding:3px;border:1px solid #2a2f47;filter:drop-shadow(0 2px 6px rgba(0,0,0,.35))}
    .brand{line-height:1}
    .brand h1{margin:0;font-size:24px}
    .tag{display:inline-flex;gap:8px;align-items:center;color:#ffd1d1;background:#170909;border:1px solid #3b0d0d;border-radius:999px;padding:6px 10px;font-size:12px}
    .grid{display:grid;grid-template-columns:1.15fr .85fr;gap:16px}
    @media (max-width:1024px){.grid{grid-template-columns:1fr}}

    .card{background:var(--panel);border:1px solid var(--line);border-radius:16px;box-shadow:0 8px 28px rgba(0,0,0,.35)}
    .card h3{margin:0 0 6px;font-size:14px;font-weight:600;color:var(--muted)}
    .pad{padding:14px}
    .toolbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    .tool{display:inline-flex;align-items:center;justify-content:center;gap:6px;padding:9px 10px;border:1px solid #2b3049;background:#0e1221;border-radius:10px;color:var(--ink);cursor:pointer;user-select:none}
    .tool svg{width:18px;height:18px}
    .tool[aria-pressed="true"], .tool.primary{background:var(--accent);border-color:var(--accent-2)}
    .tool:hover{transform:translateY(-1px)}
    .divider{height:1px;background:#1e2337;margin:12px 0}

    textarea{width:100%;min-height:220px;background:#0b0d14;color:var(--ink);border:1px solid #25283a;border-radius:12px;padding:14px 16px;font-size:16px;outline:none;resize:vertical}

    .controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    .btn{background:#171a27;border:1px solid #2a2f47;color:var(--ink);padding:10px 12px;border-radius:12px;font-weight:600;cursor:pointer}
    .btn:hover{transform:translateY(-1px);background:#1b1f31;border-color:#3b4262}
    .btn.primary{background:var(--accent);border-color:var(--accent-2)}
    .btn.good{background:var(--ok);border-color:#27da97}

    .groupTitle{display:flex;align-items:center;gap:6px;color:#dbe0ff;font-size:12px;margin:8px 0}

    .chip{display:inline-flex;align-items:center;gap:8px;padding:8px 10px;border:1px solid #2a2f47;background:#0f1320;border-radius:10px}
    .chip input{accent-color:var(--accent)}

    .muted{color:var(--muted);font-size:12px}

    /* Right preview column */
    .previewShell{padding:12px}
    .preview{background:#fff;color:#111;border-radius:12px;overflow:hidden;border:1px solid #d2d6de}
    .liTop{display:flex;gap:10px;align-items:flex-start;padding:12px}
    .liTop img{height:40px;width:40px;border-radius:50%}
    .liName{font-weight:600}
    .liMeta{font-size:12px;color:#666}
    .liFollow{margin-left:auto;background:#0a66c2;color:#fff;border:0;border-radius:999px;padding:6px 10px;font-weight:600}
    .liBody{padding:0 12px 12px;white-space:pre-wrap;word-break:break-word}
    .liImage{width:100%;display:none;max-height:380px;object-fit:cover;background:#f5f6f8}
    .liActions{display:flex;gap:18px;border-top:1px solid #eef1f5;padding:10px 12px;color:#5f6b7a;font-size:13px}
    .deviceRow{display:flex;align-items:center;gap:10px;margin:8px 0 0}
    .deviceRow .chip{background:#0b0f1e}

    /* Character progress */
    .meter{height:8px;background:#0d1223;border-radius:999px;border:1px solid #232a43;overflow:hidden}
    .meter>i{display:block;height:100%;background:linear-gradient(90deg,var(--accent),#ff9b73)}

    /* Fancy fonts grid */
    .gridFonts{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:8px}

    .footerNote{color:#ffd1d1;background:#170909;border:1px solid #3b0d0d;border-radius:10px;padding:8px 10px;margin-top:10px}

    /* Recommendations */
    .recoGrid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:10px;margin-top:8px}
    .recoCard{background:#0f1320;border:1px solid #2a2f47;border-radius:12px;padding:10px}
    .recoHead{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
    .recoTitle{font-weight:700}
    .recoDesc{color:var(--muted);font-size:12px}
    .recoText{white-space:pre-wrap;word-break:break-word;background:#0b0d14;border:1px solid #25283a;border-radius:8px;padding:8px;margin:8px 0;max-height:160px;overflow:auto}
    .recoBtns{display:flex;gap:8px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <!-- Put your logo file as logo.png next to index.html -->
      <img src="logo.png" alt="CRM Hacker logo" onerror="this.style.display='none'">
      <div class="brand">
        <h1>CRM Hacker — LinkedIn Text Formatter</h1>
        <!-- Tagline kept but without FUBU -->
        <div class="tag">Built by CRM Hacker</div>
      </div>
    </div>

    <div class="grid">
      <!-- LEFT: Editor + controls -->
      <div class="card pad">
        <h3>Editor</h3>
        <div class="toolbar" aria-label="toolbar">
          <!-- style buttons (apply to selection if any, otherwise whole text) -->
          <button class="tool" data-act="bold" title="Bold"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M7 6h6a3 3 0 110 6H7zm0 6h7a3 3 0 110 6H7"/></svg></button>
          <button class="tool" data-act="italic" title="Italic"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 4h7M7 20h7M14 4L10 20"/></svg></button>
          <button class="tool" data-act="underline" title="Underline"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 6v6a6 6 0 0012 0V6"/><path d="M6 20h12"/></svg></button>
          <button class="tool" data-act="strike" title="Strikethrough"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 12h16"/></svg></button>
          <span style="width:10px"></span>
          <button class="tool" data-act="bullets" title="Bulleted list"><svg viewBox="0 0 24 24" fill="currentColor"><circle cx="6" cy="7" r="2"/><circle cx="6" cy="12" r="2"/><circle cx="6" cy="17" r="2"/><path d="M11 7h9M11 12h9M11 17h9" stroke="currentColor" stroke-width="2" fill="none"/></svg></button>
          <button class="tool" data-act="numbers" title="Numbered list"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 7h10M10 12h10M10 17h10"/><path d="M5 8V6H3v2h2zM4 12h2v4H4m0 0h2"/></svg></button>
          <button class="tool" data-act="quote" title="Quote"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M7 7h7v6H7zM14 7h7v6h-7z"/></svg></button>
          <button class="tool" data-act="clear" title="Clear formatting"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 7h16M10 7v10M7 17h6"/></svg></button>
        </div>

        <div class="divider"></div>

        <textarea id="input" placeholder="Write or paste your post…">Busy ≠ productive. Especially in RevOps.
Busy work. Busy work. Busy work.</textarea>

        <div style="height:8px"></div>
        <div class="controls">
          <button class="btn primary" id="formatBtn">Format → Preview</button>
          <button class="btn" id="recommendBtn">Recommend formatting</button>
          <span class="muted" id="counts">0 chars • 0 words</span>
        </div>

        <!-- Where recommendations will render -->
        <div id="recoArea"></div>

        <!-- Sorting / Staircase -->
        <div class="groupTitle">Sort / Staircase</div>
        <div class="toolbar">
          <label class="chip"><input type="radio" name="sort" value="none" checked> None</label>
          <label class="chip"><input type="radio" name="sort" value="asc"> Short → Long</label>
          <label class="chip"><input type="radio" name="sort" value="desc"> Long → Short</label>
          <label class="chip"><input type="radio" name="sort" value="stair"> Staircase (S-L-S)</label>
          <span class="muted">Reorders by line length.</span>
        </div>

        <!-- Fancy fonts and overlays -->
        <div class="groupTitle">Fancy fonts (Unicode) & overlays</div>
        <div class="gridFonts" id="fontsGrid"></div>
        <div class="toolbar" style="margin-top:8px">
          <label class="chip"><input type="checkbox" id="ovStrike"> Strikethrough</label>
          <label class="chip"><input type="checkbox" id="ovUnder"> Underline</label>
          <label class="chip"><input type="checkbox" id="ovOver"> Overline</label>
          <label class="chip"><input type="checkbox" id="ovSlash"> Slash</label>
          <label class="chip"><input type="checkbox" id="ovWavy"> Wavy</label>
          <label class="chip"><input type="checkbox" id="ovDot"> Dot above</label>
          <label class="chip"><input type="checkbox" id="ovRing"> Ring above</label>
          <label class="chip"><input type="checkbox" id="sentStrike"> Strike per sentence</label>
        </div>

        <div class="divider"></div>
        <div class="toolbar">
          <label class="chip"><input type="checkbox" id="upper"> UPPER</label>
          <label class="chip"><input type="checkbox" id="lower"> lower</label>
          <label class="chip"><input type="checkbox" id="title"> Title</label>
          <label class="chip"><input type="checkbox" id="tiny"> Tiny</label>
          <label class="chip"><input type="checkbox" id="sub"> Sub</label>
          <label class="chip"><input type="checkbox" id="sup"> Sup</label>
          <label class="chip"><input type="checkbox" id="clean"> Remove marks</label>
        </div>

        <div class="footerNote">© CRM Hacker</div>
      </div>

      <!-- RIGHT: LinkedIn preview -->
      <div class="card previewShell">
        <h3>Preview</h3>
        <div class="deviceRow">
          <label class="chip"><input type="radio" name="device" value="desktop" checked> Desktop</label>
          <label class="chip"><input type="radio" name="device" value="mobile"> Mobile</label>
          <div class="chip"><input type="file" id="imagePick" accept="image/*"><span>Attach image</span></div>
          <button class="btn good" id="copyBtn">Copy Output</button>
        </div>
        <div style="height:8px"></div>
        <div class="meter"><i id="meterBar" style="width:0%"></i></div>
        <div class="muted" id="limitInfo" style="margin-top:4px">0 / 3000</div>

        <div id="preview" class="preview" style="margin-top:12px;max-width:760px">
          <div class="liTop">
            <img src="https://i.pravatar.cc/100?img=3" alt="avatar">
            <div>
              <div class="liName">CRM Hacker</div>
              <div class="liMeta">Company • Just now • <span style="color:var(--li-blue)">#CRM #RevOps</span></div>
            </div>
            <button class="liFollow">Follow</button>
          </div>
          <div class="liBody" id="liBody"></div>
          <img id="liImage" class="liImage" alt="attached image" />
          <div class="liActions">
            <span>👍 Like</span>
            <span>💬 Comment</span>
            <span>↗ Share</span>
            <span>•••</span>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
  // ===== Utilities
  const $ = (s,ctx=document)=>ctx.querySelector(s);
  const $$ = (s,ctx=document)=>Array.from(ctx.querySelectorAll(s));
  const input = $('#input');
  const liBody = $('#liBody');
  const meterBar = $('#meterBar');
  const limitInfo = $('#limitInfo');

  const LINKEDIN_LIMIT = 3000; // characters

  function updateCounts(){
    const text = input.value;
    const chars = [...text].length;
    const words = text.trim()? text.trim().split(/\s+/).length : 0;
    $('#counts').textContent = `${chars} chars • ${words} words`;
    const pct = Math.min(100, Math.round(chars / LINKEDIN_LIMIT * 100));
    meterBar.style.width = pct + '%';
    limitInfo.textContent = `${chars} / ${LINKEDIN_LIMIT}`;
    limitInfo.style.color = chars>LINKEDIN_LIMIT ? 'var(--warn)' : 'var(--muted)';
  }

  input.addEventListener('input', updateCounts);

  // ===== Toolbar actions that alter the textarea text
  function applyToSelection(fn){
    const el = input;
    const start = el.selectionStart, end = el.selectionEnd;
    if(start !== end){
      const before = el.value.slice(0,start);
      const sel = el.value.slice(start,end);
      const after = el.value.slice(end);
      const out = fn(sel);
      el.value = before + out + after;
      el.selectionStart = start; el.selectionEnd = start + out.length;
    } else {
      el.value = fn(el.value);
    }
    updateCounts();
  }

  function actBold(s){ return mapRun(s,'bold'); }
  function actItalic(s){ return mapRun(s,'italic'); }
  function actUnderline(s){ return overlay(s,['\u0332']); }
  function actStrike(s){ return overlay(s,['\u0336']); }
  function actBullets(s){ return s.split(/\n/).map(line=> line.trim()? (line.replace(/^([•\-\*]\s+)/,'').replace(/^/,'• ')) : '').join('\n'); }
  function actNumbers(s){ let i=1; return s.split(/\n/).map(line=> line.trim()? `${i++}. ${line.replace(/^\d+\.\s+/,'')}` : '').join('\n'); }
  function actQuote(s){ return s.split(/\n/).map(l=> l? '“'+l+'”' : '').join('\n'); }
  function actClear(s){ return removeCombining(s.normalize('NFKD')); }

  const handler = {
    bold: ()=>applyToSelection(actBold),
    italic: ()=>applyToSelection(actItalic),
    underline: ()=>applyToSelection(actUnderline),
    strike: ()=>applyToSelection(actStrike),
    bullets: ()=>applyToSelection(actBullets),
    numbers: ()=>applyToSelection(actNumbers),
    quote: ()=>applyToSelection(actQuote),
    clear: ()=>applyToSelection(actClear)
  }
  $$('.tool').forEach(btn=> btn.addEventListener('click', ()=> handler[btn.dataset.act]()));

  // ===== Unicode fancy maps
  const A='ABCDEFGHIJKLMNOPQRSTUVWXYZ', a='abcdefghijklmnopqrstuvwxyz', D='0123456789';
  const buildMap=(U,L,N)=>{const m=new Map(); if(U!=null)for(let i=0;i<26;i++)m.set(A[i],String.fromCodePoint(U+i)); if(L!=null)for(let i=0;i<26;i++)m.set(a[i],String.fromCodePoint(L+i)); if(N!=null)for(let i=0;i<10;i++)m.set(D[i],String.fromCodePoint(N+i)); return m;};
  const MAPS={
    plain:new Map(),
    bold:buildMap(0x1D400,0x1D41A,0x1D7CE),
    italic:buildMap(0x1D434,0x1D44E,null),
    boldItalic:buildMap(0x1D468,0x1D482,null),
    sans:buildMap(0x1D5A0,0x1D5BA,0x1D7E2),
    sansBold:buildMap(0x1D5D4,0x1D5EE,0x1D7EC),
    mono:buildMap(0x1D670,0x1D68A,0x1D7F6),
    scriptBold:buildMap(0x1D4D0,0x1D4EA,null),
    frakturBold:buildMap(0x1D56C,0x1D586,null),
    doublestruck:buildMap(0x1D538,0x1D552,0x1D7D8),
    fullwidth:buildMap(0xFF21,0xFF41,0xFF10),
    circled:(()=>{const m=new Map();for(let i=0;i<26;i++){m.set(A[i],String.fromCodePoint(0x24B6+i));m.set(a[i],String.fromCodePoint(0x24D0+i));}m.set('0',String.fromCodePoint(0x24EA));for(let i=1;i<=10;i++)m.set(String(i%10),String.fromCodePoint(0x2460+i-1));return m;})(),
    squared:(()=>{const m=new Map();for(let i=0;i<26;i++){m.set(A[i],String.fromCodePoint(0x1F130+i));m.set(a[i],String.fromCodePoint(0x1F130+i));}return m;})(),
    smallcaps:new Map([...a].map((c,i)=>[c,A[i]]))
  };

  const FONT_OPTIONS=[
    ['bold','Bold'],['italic','Italic'],['boldItalic','Bold Italic'],['sans','Sans'],['sansBold','Sans Bold'],['mono','Monospace'],['scriptBold','Cursive'],['frakturBold','Fraktur'],['doublestruck','Double-struck'],['fullwidth','Fullwidth'],['circled','Circled'],['squared','Squared'],['smallcaps','Small caps']
  ];

  const fontsGrid = $('#fontsGrid');
  FONT_OPTIONS.forEach(([id,label])=>{
    const lab=document.createElement('label');lab.className='chip';
    const rb=document.createElement('input');rb.type='radio';rb.name='font';rb.value=id;lab.append(rb,document.createTextNode(' '+label));
    fontsGrid.appendChild(lab);
  });
  // default none selected

  // ===== overlays and helpers
  const CM={ strike:'\u0336', underline:'\u0332', overline:'\u0305', slash:'\u0337', wavy:'\u0334', dot:'\u0307', ring:'\u030A' };
  const CM_RE=/\p{Mn}+/gu;
  const removeCombining=s=>s.normalize('NFD').replace(CM_RE,'');
  const overlay=(s,marks)=>{const combo=marks.join('');return [...s].map(ch=> (ch===' '||ch==='\n')? ch : ch+combo).join('');}

  const tinyMap=new Map(Object.entries({a:'ᵃ',b:'ᵇ',c:'ᶜ',d:'ᵈ',e:'ᵉ',f:'ᶠ',g:'ᵍ',h:'ʰ',i:'ᶦ',j:'ʲ',k:'ᵏ',l:'ˡ',m:'ᵐ',n:'ⁿ',o:'ᵒ',p:'ᵖ',q:'ᑫ',r:'ʳ',s:'ˢ',t:'ᵗ',u:'ᵘ',v:'ᵛ',w:'ʷ',x:'ˣ',y:'ʸ',z:'ᶻ',A:'ᴬ',B:'ᴮ',C:'ᶜ',D:'ᴰ',E:'ᴱ',F:'ᶠ',G:'ᴳ',H:'ᴴ',I:'ᴵ',J:'ᴶ',K:'ᴷ',L:'ᴸ',M:'ᴹ',N:'ᴺ',O:'ᴼ',P:'ᴾ',Q:'ᑫ',R:'ᴿ',S:'ˢ',T:'ᵀ',U:'ᵁ',V:'ⱽ',W:'ᵂ',X:'ˣ',Y:'ʸ',Z:'ᶻ',0:'⁰',1:'¹',2:'²',3:'³',4:'⁴',5:'⁵',6:'⁶',7:'⁷',8:'⁸',9:'⁹'}));
  const subMap=new Map(Object.entries({a:'ₐ',e:'ₑ',h:'ₕ',i:'ᵢ',j:'ⱼ',k:'ₖ',l:'ₗ',m:'ₘ',n:'ₙ',o:'ₒ',p:'ₚ',r:'ᵣ',s:'ₛ',t:'ₜ',u:'ᵤ',v:'ᵥ',x:'ₓ',0:'₀',1:'₁',2:'₂',3:'₃',4:'₄',5:'₅',6:'₆',7:'₇',8:'₈',9:'₉'}));
  const supMap=new Map(); 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+-=()'.split('').forEach(ch=>{supMap.set(ch,tinyMap.get(ch)||({'0':'⁰','1':'¹','2':'²','3':'³','4':'⁴','5':'⁵','6':'⁶','7':'⁷','8':'⁸','9':'⁹','+':'⁺','-':'⁻','=':'⁼','(':'⁽',')':'⁾'})[ch]||ch)});

  function transformWithMap(s,map){return [...s].map(ch=> map.get(ch)||ch).join('');}
  const toTitle=s=>s.toLowerCase().replace(/\b([a-z])(\w*)/g,(_,h,rest)=>h.toUpperCase()+rest);

  function sentenceStrike(s){ return [...s].map(ch=> (ch===' '||ch==='\n')? ch : ch+CM.strike).join(''); }

  function mapRun(s,id){ const m = MAPS[id]; return m? transformWithMap(s,m) : s; }

  // ===== Sorting / staircase by line length
  function sortLines(text,mode){
    if(mode==='none') return text;
    const lines = text.split(/\n/);
    const items = lines.map((t,i)=>({t,i,len:[...t].length}));
    items.sort((a,b)=> a.len-b.len );
    let order=[];
    if(mode==='asc') order=items.map(x=>x);
    else if(mode==='desc') order=items.reverse();
    else if(mode==='stair'){
      // alternate short/long/short/long
      let l=0, r=items.length-1; while(l<=r){ if(l===r){order.push(items[l]);break;} order.push(items[l++],items[r--]); }
    }
    return order.map(o=>o.t).join('\n');
  }

  // ===== Main formatter (applies checkboxes/radios to the full text and updates preview)
  function runFormat(){
    let s = input.value || '';

    // case
    if($('#upper').checked) s = s.toUpperCase();
    else if($('#lower').checked) s = s.toLowerCase();
    else if($('#title').checked) s = toTitle(s);

    // sort by line length
    const sortMode = ($('input[name="sort"]:checked')||{}).value || 'none';
    s = sortLines(s, sortMode);

    // font map
    const font = ($('input[name="font"]:checked')||{}).value;
    if(font) s = mapRun(s, font);

    // specials
    if($('#tiny').checked) s = [...s].map(ch=> tinyMap.get(ch)||ch).join('');
    if($('#sub').checked) s = [...s].map(ch=> subMap.get(ch)||ch).join('');
    if($('#sup').checked) s = [...s].map(ch=> supMap.get(ch)||ch).join('');

    // overlays
    const marks=[]; if($('#ovStrike').checked) marks.push(CM.strike); if($('#ovUnder').checked) marks.push(CM.underline); if($('#ovOver').checked) marks.push(CM.overline); if($('#ovSlash').checked) marks.push(CM.slash); if($('#ovWavy').checked) marks.push(CM.wavy); if($('#ovDot').checked) marks.push(CM.dot); if($('#ovRing').checked) marks.push(CM.ring);
    if($('#sentStrike').checked && marks.includes(CM.strike)){
      s = sentenceStrike(s);
      s = overlay(s, marks.filter(m=>m!==CM.strike));
    } else if(marks.length){ s = overlay(s, marks); }

    if($('#clean').checked){ s = removeCombining(s); if(marks.length) s = overlay(s, marks); }

    // update preview
    liBody.textContent = s;
    updateCounts();
  }

  // ===== Recommendations
  function looksLikeList(s){ return /^\s*[-•\d]/m.test(s) || s.split('\n').filter(x=>x.trim()).length >= 3; }
  function toBullets(s){ return s.split(/\n/).map(l=> l.trim()? '• '+l.replace(/^([•\-\*\d\.]+\s*)/,'') : '').join('\n'); }
  function recommendVariants(src){
    const variants = [];
    variants.push({ label:'Headline', desc:'Bold + Title Case for hooks', text: mapRun(toTitle(src),'bold') });
    variants.push({ label:'Emphasis', desc:'Italic + Underline', text: overlay(mapRun(src,'italic'),['\u0332']) });
    variants.push({ label:'Clean', desc:'Small caps—subtle polish', text: mapRun(src,'smallcaps') });
    const perSentence = [...src].map(ch => (ch===' '||ch==='\n')? ch : ch+'\u0336').join('');
    variants.push({ label:'Callout', desc:'Strike per sentence', text: perSentence });
    if (looksLikeList(src)) variants.push({ label:'List', desc:'Auto-bulleted', text: toBullets(src) });
    else variants.push({ label:'Punchy', desc:'Bold + Strike', text: overlay(mapRun(src,'bold'),['\u0336']) });
    variants.push({ label:'Subtle', desc:'Title + Underline', text: overlay(toTitle(src),['\u0332']) });
    variants.push({ label:'Monospace', desc:'Code-style clarity', text: mapRun(src,'mono') });
    variants.push({ label:'Cursive', desc:'Script for taglines', text: mapRun(src,'scriptBold') });
    return variants;
  }
  function renderRecommendations(list){
    const host = document.getElementById('recoArea');
    if (!list || !list.length){ host.innerHTML = ''; return; }
    host.innerHTML = `<div class="groupTitle">Recommended formatting</div>
      <div class="recoGrid">
        ${list.map((v,i)=>`
          <div class="recoCard">
            <div class="recoHead"><div class="recoTitle">${v.label}</div></div>
            <div class="recoDesc">${v.desc}</div>
            <div class="recoText" id="recoText_${i}">${v.text}</div>
            <div class="recoBtns">
              <button class="btn" data-use="${i}">Use this</button>
              <button class="btn" data-copy="${i}">Copy</button>
            </div>
          </div>`).join('')}
      </div>`;
    host.querySelectorAll('[data-use]').forEach(btn=>{
      btn.addEventListener('click', e=>{
        const idx = +e.currentTarget.dataset.use;
        liBody.textContent = list[idx].text;
      });
    });
    host.querySelectorAll('[data-copy]').forEach(btn=>{
      btn.addEventListener('click', async e=>{
        const idx = +e.currentTarget.dataset.copy;
        await navigator.clipboard.writeText(list[idx].text);
        e.currentTarget.textContent = 'Copied!';
        setTimeout(()=> e.currentTarget.textContent='Copy', 900);
      });
    });
  }

  // image upload for preview
  $('#imagePick').addEventListener('change', (e)=>{
    const f = e.target.files?.[0]; if(!f) return; const url = URL.createObjectURL(f); const im = $('#liImage'); im.src=url; im.style.display='block';
  });

  // device width toggle
  $$('input[name="device"]').forEach(rb=> rb.addEventListener('change',()=>{
    const box=$('#preview'); box.style.maxWidth = rb.value==='mobile'? '420px':'760px';
  }));

  // wire buttons
  $('#formatBtn').addEventListener('click', runFormat);
  $('#recommendBtn').addEventListener('click', ()=> renderRecommendations(recommendVariants(input.value||'')));
  $('#copyBtn').addEventListener('click', ()=> navigator.clipboard.writeText(liBody.textContent||''));

  // live counts and initial preview
  updateCounts();
  runFormat();
</script>
</body>
</html>
